/* ========== フォント ========== */
/* Adobe kit 側で読み込まれるフォント名に合わせること */
:root{
  --gothic: "dnp-shuei-gothic-kin-std","Yu Gothic","Hiragino Kaku Gothic ProN",Meiryo,sans-serif; /* 秀英角ゴ */
  --mincho: "ten-mincho","Hiragino Mincho ProN","Yu Mincho",serif; /* 貂明朝 */
}

/* ========== ベース ========== */
*{box-sizing:border-box}
html{height:100%;-webkit-text-size-adjust:100%}
body{
  margin:0;background:#000;color:#eee;font-family:var(--mincho);
  -webkit-font-smoothing:antialiased;
}

/* 1画面ずつ表示（他は display:none） */
.screen{display:none;min-height:100vh;width:100%;padding:0 6%;
  justify-content:center;align-items:center;text-align:center;position:relative}
.screen.active{display:flex}
.center{max-width:760px;width:100%}
.spaced{letter-spacing:.22em;line-height:1.9}
.percent{margin-top:.6rem;color:#777}
.warning{color:#8b0000}

/* ---- 黒背景の前置き ---- */
.dark-center{background:#000}
.preface-wrap{max-width:820px;margin:auto}
.preface-line{
  margin:.45rem 0; font-size:clamp(14px,4.2vw,20px); color:#fff; opacity:0;
  animation:prefaceGlitchIn .9s ease forwards;
}
#preface-line2{ animation-delay:.35s }
@keyframes prefaceGlitchIn{
  0%{opacity:0;filter:blur(4px)}
  25%{opacity:.6;text-shadow:1px 0 rgba(255,0,0,.4),-1px 0 rgba(0,255,255,.4)}
  50%{opacity:.85;filter:blur(1px)}
  70%{opacity:.92}
  100%{opacity:1;filter:none;text-shadow:none}
}

/* 全体ノイズ（薄い粒状） */
#noise{position:fixed;inset:0;background:rgba(255,255,255,.03);
  opacity:.06;pointer-events:none;z-index:1;transition:opacity .25s}

/* FXレイヤ（走査線/細キズ/ロールバー） */
#fx{position:fixed;inset:0;pointer-events:none;z-index:12;mix-blend-mode:overlay}
.fx-grain,.fx-scratches,.fx-rollbar{position:absolute;inset:0}
.fx-grain{
  background-image:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,.05), rgba(0,0,0,0) 38%),
    radial-gradient(circle at 70% 60%, rgba(255,255,255,.04), rgba(0,0,0,0) 42%),
    repeating-conic-gradient(from 0deg, rgba(255,255,255,.06) 0 .5deg, rgba(0,0,0,0) .5deg 1deg);
  opacity:.22;animation:fxGrainShift 1.2s steps(2) infinite
}
@keyframes fxGrainShift{0%{transform:translate(0,0)}50%{transform:translate(-1px,1px)}100%{transform:translate(0,0)}}
.fx-scratches{
  background:
    repeating-linear-gradient(to right, rgba(255,255,255,.08) 0 1px, rgba(0,0,0,0) 1px 4px),
    repeating-linear-gradient(to right, rgba(255,255,255,.03) 0 2px, rgba(0,0,0,0) 2px 7px);
  opacity:.12;animation:fxScratchDrift 12s linear infinite
}
@keyframes fxScratchDrift{0%{transform:translateX(0)}100%{transform:translateX(-60px)}}
.fx-rollbar{background:linear-gradient(to bottom,rgba(255,255,255,0),rgba(255,255,255,.2) 50%,rgba(255,255,255,0));opacity:0;transform:translateY(-120%)}
.fx-rollbar.run{animation:fxRoll 2.2s linear 1}
@keyframes fxRoll{0%{opacity:0;transform:translateY(-120%)}10%{opacity:.38}90%{opacity:.38}100%{opacity:0;transform:translateY(120%)}}

/* ---- 見出し／発光 ---- */
.kaiki{
  color:#8b0000; font-size:clamp(22px,8.2vw,42px); letter-spacing:.08em; line-height:1.2;
  text-wrap:balance; white-space:nowrap; font-family:var(--mincho);
}
.kaiki.glow{
  color:#b30000;
  text-shadow:
    0 0 4px rgba(139,0,0,.55),
    0 0 10px rgba(139,0,0,.45),
    0 0 18px rgba(255,0,0,.25);
}
.kaiki-sub{margin:.2rem 0 10px;color:#8b0000;letter-spacing:.12em;font-size:1rem;font-family:var(--gothic)}
.who-line{color:#aaa;letter-spacing:.18em;margin:.2rem 0 .8rem;font-size:clamp(12px,3.6vw,14px)}

/* ---- レトロUI（ウィンドウ内は秀英角ゴ） ---- */
.browser.retro{
  position:relative;z-index:2;width:100%;max-width:900px;background:#c0c0c0;border:2px solid #000;
  box-shadow:0 0 0 1px #fff inset,0 0 0 2px #808080 inset,0 0 0 3px #fff inset;overflow:hidden;
  font-family:var(--gothic);
}
.browser.small{max-width:820px}
.rounded{border-radius:10px}
.retro-titlebar{
  display:flex;align-items:center;justify-content:space-between;background:#000080;color:#fff;padding:6px 8px;
  letter-spacing:.22em;font-size:.85rem;user-select:none;white-space:nowrap
}
.retro-title{font-weight:bold}
.retro-title.nowrap{white-space:nowrap}
.retro-controls{display:flex;gap:6px}
.retro-controls .ctrl{min-width:22px;text-align:center;padding:2px 4px;background:#c0c0c0;color:#000;border:2px solid #000;
  box-shadow:0 0 0 1px #fff inset,0 0 0 2px #808080 inset,0 0 0 3px #fff inset}
.retro-controls .ctrl:active{box-shadow:0 0 0 1px #808080 inset,0 0 0 2px #fff inset,0 0 0 3px #808080 inset}
.retro-controls .ctrl.close{color:#800000}
.retro-pane{padding:12px;text-align:left;color:#000;background:#c0c0c0;position:relative}

/* CRT質感（ウィンドウ/カルテ） */
.crt{position:relative;isolation:isolate;overflow:hidden;filter:contrast(1.03) saturate(0.98)}
.crt::before{
  content:"";position:absolute;inset:-4%;z-index:8;pointer-events:none;
  background:radial-gradient(ellipse at center,rgba(255,255,255,.02) 0%,rgba(255,255,255,0) 60%,rgba(0,0,0,.38) 100%);
  border-radius:3%/2%;transform:perspective(1000px) scale(1.018)
}
.crt::after{
  content:"";position:absolute;inset:0;z-index:8;pointer-events:none;
  background:repeating-linear-gradient(to bottom,rgba(255,255,255,.045),rgba(255,255,255,.045) 1px,transparent 1px,transparent 3px);
  mix-blend-mode:overlay;opacity:.5;animation:crtFlicker 4.5s steps(1) infinite
}
@keyframes crtFlicker{0%,98%{opacity:.5}99%{opacity:.56}100%{opacity:.5}}
.phosphor{ text-shadow:0 0 .4px rgba(0,0,0,.35), 0 0 6px rgba(255,255,255,.08) }

/* ---- 背景ノイズ動画 ---- */
.bg-video{
  position:fixed; inset:auto; left:0; top:0; width:100vw; height:100vh; object-fit:cover;
  opacity:.55; z-index:0; filter:saturate(0.85) hue-rotate(-6deg);
  pointer-events:none;
}

/* ---- 発祥画面：ページ自体スクロール可 ---- */
.story-scroll{align-items:flex-start;padding-top:36px;padding-bottom:60px}
.stack{display:flex;flex-direction:column;gap:12px;width:100%;max-width:980px;margin:0 auto}

/* 本文（改行詰め・本文は秀英角ゴ） */
.typewriter{color:#111;line-height:1.8;font-size:clamp(14px,3.6vw,17px);letter-spacing:.01em;
  white-space:normal;word-break:normal;overflow-wrap:anywhere;line-break:strict;text-wrap:pretty;
  font-family:var(--gothic);
}
.typewriter p{margin:0 0 1.05em 0}

/* スクロールボックス */
.scrollbox{
  max-height:55vh;overflow-y:auto;overflow-x:hidden;padding:10px;background:#fff;color:#111;border:2px solid #000;
  box-shadow:0 0 0 1px #fff inset,0 0 0 2px #808080 inset,0 0 0 3px #fff inset
}
.scrollbox::-webkit-scrollbar{width:10px}
.scrollbox::-webkit-scrollbar-track{background:#c0c0c0;box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #808080}
.scrollbox::-webkit-scrollbar-thumb{background:#e0e0e0;border:2px solid #000;box-shadow:inset 0 0 0 1px #fff,inset 0 0 0 2px #808080,inset 0 0 0 3px #fff}

/* “たすけて” */
.help-chant{color:#8b0000;letter-spacing:0;font-weight:600;opacity:0;transition:opacity .25s ease}

/* ボタン */
.btn{
  background:#c0c0c0;color:#000;border:2px solid #000;
  box-shadow:0 0 0 1px #fff inset,0 0 0 2px #808080 inset,0 0 0 3px #fff inset;
  border-radius:4px;margin-top:16px;padding:.55rem 1rem;cursor:pointer;transition:transform .1s,color .2s,box-shadow .12s
}
.btn:hover{color:#8b0000}
.btn:active{box-shadow:0 0 0 1px #808080 inset,0 0 0 2px #fff inset,0 0 0 3px #808080 inset;transform:translateY(1px) scale(.99)}

/* 受付大きめ */
.entry-form.big{gap:10px;align-items:center;margin:.8rem 0 .5rem}
#nick-input{
  width:100%;max-width:420px;padding:.7rem .8rem;background:#fff;color:#111;border:2px solid #000;
  box-shadow:0 0 0 1px #fff inset,0 0 0 2px #808080 inset,0 0 0 3px #fff inset
}
#nick-input:focus{outline:none;border-color:#8b0000}
.entry-note{color:#333;font-size:.85rem;margin:.25rem 0 0}

/* カルテ一覧 */
.records{position:relative;z-index:2;width:100%;max-width:900px;text-align:left}
.records-title{text-align:center;color:#8b0000;letter-spacing:.12em;font-family:var(--gothic)}
.card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:8px;padding:12px;margin:12px 0}
.karte{width:100%;border-collapse:collapse;table-layout:fixed;font-family:var(--gothic)}
.karte th,.karte td{padding:8px;border-bottom:1px dashed rgba(255,255,255,.08);vertical-align:top;word-break:break-word}
.karte th{white-space:nowrap;width:30%}

/* モーダル */
#modal{position:fixed;inset:0;background:rgba(0,0,0,.86);z-index:9999;display:flex;justify-content:center;align-items:center;padding:20px;text-align:left;opacity:0;pointer-events:none;transition:opacity .22s}
#modal.open{opacity:1;pointer-events:auto}
.modal-inner{width:92%;max-width:680px;background:#0b0b0b;border:1px solid rgba(255,255,255,.08);border-radius:8px;padding:16px;transform:scale(.96) translateY(8px);transition:transform .22s,box-shadow .22s;box-shadow:0 18px 50px rgba(0,0,0,.55);font-family:var(--gothic)}
#modal.open .modal-inner{transform:scale(1) translateY(0);box-shadow:0 22px 60px rgba(0,0,0,.65)}
.modal-title{margin:0 0 10px;color:#8b0000}
.modal-body{line-height:1.9}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}

/* 斜めしましまモザイク */
.mosaic{position:relative;display:inline-block;color:transparent;padding:0 .25em;border-radius:2px;outline:1px solid rgba(255,255,255,.12)}
.mosaic::after{
  content:"";position:absolute;inset:0;border-radius:2px;
  background:repeating-linear-gradient(135deg,rgba(20,20,20,1) 0 6px,rgba(0,0,0,.78) 6px 12px),
             linear-gradient(to bottom,rgba(255,255,255,.05),rgba(0,0,0,.0));
  opacity:.96;animation:mosaicPulse 3s ease-in-out infinite
}
@keyframes mosaicPulse{0%,100%{opacity:.96}50%{opacity:.86}}

/* “ボワッ”登場（ウィンドウ） */
.will-pop{opacity:0;transform:translateY(30px) scale(.98)}
.will-pop.show{animation:popIn .42s cubic-bezier(.2,.7,.2,1) forwards}
@keyframes popIn{
  0%{opacity:0;transform:translateY(28px) scale(.98)}
  70%{opacity:1;transform:translateY(2px) scale(1)}
  100%{opacity:1;transform:translateY(0) scale(1)}
}

/* 微振動 & ランダム“ガガガ” */
@keyframes jolt{0%{transform:none;filter:none}15%{transform:skewX(2deg) translateX(1px)}
30%{transform:skewX(-2deg) translateX(-1px);filter:contrast(1.08)}45%{transform:skewY(1deg)}
60%{transform:skewY(-1deg)}75%{transform:translateX(1px)}100%{transform:none;filter:none}}
.jolt{animation:jolt .22s steps(1) 1}

/* スマホ */
@media (max-width:430px){
  .scrollbox{max-height:60vh}
  .retro-titlebar{font-size:.82rem;letter-spacing:.18em}
}
